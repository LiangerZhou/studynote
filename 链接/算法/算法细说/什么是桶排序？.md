> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 https://mp.weixin.qq.com/s?__biz=MzIxMjE5MTE1Nw==&mid=2653195582&idx=1&sn=1e7ece4e48c20fb994e2cefdcbdce4c5&chksm=8c99ffe4bbee76f23d16ac1e0c7feeb16654ebb75e40d92c911bffa113059f52ce4508281a55&scene=21#wechat_redirect

点击上方 “程序员小灰”，选择关注公众号

有趣有内涵的文章第一时间送达！

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoepibqkDBj1fk4cicfAlmUObORFiac8rBHyvG0qJ1Qh7VF8871jvc5KibsGOh0WxZbAhSrU3WSv0qRHQ/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGq0RMibyNCIsFJV6MTbMwOeGZHf3H1NnfNicqRhJcDuKTEymBIcEMURolqvTjkq4bVK626abf7DxbNA/640?wx_fmt=jpeg)  

**—————  第二天  —————**

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoIiakIJdIVVrxlia83FUngvia6TSlToTIgxlB4O4AXHZ5uk5qDRl6RyGUdtWicvtoGOyFqFkdpzcwnuA/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoIiakIJdIVVrxlia83FUngviaYO45rIG1DFoA6WOCcQWWbmpPiaibgUeyPpT9swvNRaodlP1Hehfp2NBw/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGq0RMibyNCIsFJV6MTbMwOeGeNgKpgFJdnqIfIDvcg0obkVXZALfbgSmaibcFJT0gIxE3h50BbDiaPWw/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGq0RMibyNCIsFJV6MTbMwOeG7UNWYgM8P1viadSVGEBYgWxvsnwWfgt5e4JOwBf9c1PibgH0xeN3txSA/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGq0RMibyNCIsFJV6MTbMwOeGOgFn7shxEPwwKdic7YZrrNrY0reNdAta1MIKgicPkv2trUKiayKBkAJVg/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGq0RMibyNCIsFJV6MTbMwOeGNkp9DnB3BGIXA47GicysVfE7j1DGXFBcrDrhBGWxXzZ0cNNjL812ljQ/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGq0RMibyNCIsFJV6MTbMwOeGCqxDEKNdmGCYjPaX7bf9PGTr3XhywE2hDefSedkrtNw3mC77gzKRWg/640?wx_fmt=jpeg)

————————————

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoIiakIJdIVVrxlia83FUngviaBHQ5lqHShF3WMicdDUxkcEdsNUpgkuVwe0vmSFnq8R8oBNjYfvYr0uA/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoIiakIJdIVVrxlia83FUngviaAUkSuoGwLYaVEuQIQGrGMBiaMwichoedn16f9Hz1fX3yb51Fnym8bFlQ/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCkRuwV6nc6B90m994DbB0mbD3EZyarnDC96P55hl6QHI7HpaDMykw9Eg/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCkK4gB3Al8hsLhuvtYCq5lTwyqO0nxOu6qEa6UsNNpoSaNFvaC9Wk3UQ/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCkT6al7JdlrEp9tl4yRUZrQqyicqgLGdLU4W4VYv2dzNTV0NHWzZW2wAg/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCketpWop9Q1KuyLyxiaQcrDEvJQo9qYCC2KVINsAiaM2Fk1ADeQYZCvEow/640?wx_fmt=jpeg)

让我们先来回顾一下计数排序：

计数排序需要根据原始数列的取值范围，创建一个统计数组，用来统计原始数列中每一个可能的整数值所出现的次数。

原始数列中的整数值，和统计数组的下标是一一对应的，以数列的最小值作为偏移量。比如原始数列的最小值是 90， 那么整数 95 对应的统计数组下标就是 95-90 = 5。

![](https://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCkCPzUU7R8XG5gPUbNoGKVVFnXWQibUWw7f8PUw5OpsnicTcq87uViapPJQ/640?wx_fmt=png)

那么，桶排序当中所谓的 “桶”，又是什么概念呢？

每一个桶（bucket）代表一个区间范围，里面可以承载一个或多个元素。桶排序的第一步，就是创建这些桶，确定每一个桶的区间范围：

![](https://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCkA2HpVXyTjsthuiaWNxZYrWrHV0yMKK7lIr6RuNDbjaqKZE7Uiae1NQbg/640?wx_fmt=png)

具体建立多少个桶，如何确定桶的区间范围，有很多不同的方式。我们这里创建的桶数量等于原始数列的元素数量，除了最后一个桶只包含数列最大值，前面各个桶的区间按照比例确定。

区间跨度 = （最大值 - 最小值）/ （桶的数量 - 1）

第二步，遍历原始数列，把元素对号入座放入各个桶中：

![](https://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCkeicz5VeTtIU1f94IHoavoJiaUcJzibEzHlENiaRvGNb3Nm9XWj7Vs6ab5g/640?wx_fmt=png)

第三步，每个桶内部的元素分别排序（显然，只有第一个桶需要排序）：

![](https://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCk8EhxHyicr0OdXWCnZmucRsWgQIggmrOytQkQ4Njdc7mXaNEqyV3xu3A/640?wx_fmt=png)

第四步，遍历所有的桶，输出所有元素：

0.5，0.84，2.18，3.25，4.5

到此为止，排序结束。

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCk6OeILFCmMmlTJcqPH6McQ1UwFkmUTOZ8icn9ra4ejIAafaFNSvfVEdQ/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCkOBECxjTAsvW8yGQgvA1e12vzdsoR5nicQEXtEmUNgib10srxICa3PRvQ/640?wx_fmt=jpeg)

```
public static double[] bucketSort(double[] array){
    //1.得到数列的最大值和最小值，并算出差值d
    double max = array[0];
    double min = array[0];
    for(int i=1; i<array.length; i++) {
        if(array[i] > max) {
            max = array[i];
        }
        if(array[i] < min) {
            min = array[i];
        }
    }
    double d = max - min;
    //2.初始化桶
    int bucketNum = array.length;
    ArrayList<LinkedList<Double>> bucketList = new ArrayList<LinkedList<Double>>(bucketNum);
    for(int i = 0; i < bucketNum; i++){
        bucketList.add(new LinkedList<Double>());
    }
    //3.遍历原始数组，将每个元素放入桶中
    for(int i = 0; i < array.length; i++){
        int num = (int)((array[i] - min)  * (bucketNum-1) / d);
        bucketList.get(num).add(array[i]);
    }
    //4.对每个通内部进行排序
    for(int i = 0; i < bucketList.size(); i++){
        //JDK底层采用了归并排序或归并的优化版本
        Collections.sort(bucketList.get(i));
    }
    //5.输出全部元素
    double[] sortedArray = new double[array.length];
    int index = 0;
    for(LinkedList<Double> list : bucketList){
        for(double element : list){
            sortedArray[index] = element;
            index++;
        }
    }
    return sortedArray;
}
public static void main(String[] args) {
    double[] array = new double[] {4.12,6.421,0.0023,3.0,2.123,8.122,4.12, 10.09};
    double[] sortedArray = bucketSort(array);
    System.out.println(Arrays.toString(sortedArray));
}

```

代码中，所有的桶保存在 ArrayList 集合当中，每一个桶被定义成一个链表（LinkedList<Double>），这样便于在尾部插入元素。

定位元素属于第几个桶，是按照比例来定位：

**(array[i] - min)  * (bucketNum-1) / d**

同时，代码使用了 JDK 的集合工具类 Collections.sort 来为桶内部的元素进行排序。Collections.sort 底层采用的是归并排序或 Timsort，小伙伴们可以简单地把它们当做是一种时间复杂度 O（nlogn）的排序。

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCkZGBvEmCRMMAJibDu7Io87NEUXARxbkgBp2oLUSTDHicuWk7RCuoSbzYg/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCkjJ3jxpZ7NcHHf1sfcLAoShsYfiahmu7IpJZRgekAb0TzhXcQV2NNWuQ/640?wx_fmt=jpeg)

假设原始数列有 n 个元素，分成 m 个桶（我们采用的分桶方式 m=n），平均每个桶的元素个数为 n/m。

下面我们来逐步分析算法复杂度：

第一步求数列最大最小值，运算量为 n。  

第二步创建空桶，运算量为 m。

第三步遍历原始数列，运算量为 n。

第四步在每个桶内部做排序，由于使用了 O（nlogn）的排序算法，所以运算量为 n/m * log(n/m ) * m。

第五步输出排序数列，运算量为 n。

加起来，总的运算量为 3n+m+ n/m * log(n/m) * m = 3n+m+n(logn-logm) 。

去掉系数，时间复杂度为：

**O(n+m+n(logn-logm)） **

至于空间复杂度就很明显了：

空桶占用的空间 + 数列在桶中占用的空间 = **O（m+n）**。

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCk0ibRsnAicwQ7FFwEicmJR3hW55HHKoskPo7F6hky4RHHic6dF0ajMjxGbQ/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCk3PMLcUiac4KEsFTRrPnXoAYlUgwKYibScXPmiaS6uhVnAC1WicMic0r2Rew/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCkETPRUwuibqZiawoubCIQgIXhEGsxTsGAspsuWq5SrmsGphngd9a4JZaQ/640?wx_fmt=jpeg)  

![](https://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCk15650HZ92uVZdKXwY3AOh3Bvl0P7ibRql5ngLB3UDfb7RaYicb6eI4SQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCkSwe4ItqOiaTL54Ij2UNM7G5sCyibGtuVMzzicP9YJOw68icRZ0BU1ljicRA/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoiafQsC1MKJHKiaePwNGlaCkRI7cyYMUOZsSjOiaCoEiad8tE5lyj66bSmMseuUibuO48Jl83rYSUBFtA/640?wx_fmt=jpeg)

有关计数排序的知识，可以看看这一篇漫画：

[漫画：什么是计数排序？](http://mp.weixin.qq.com/s?__biz=MzIxMjE5MTE1Nw==&mid=2653195533&idx=1&sn=02918dc51b07837ce1119f00d7900dbc&chksm=8c99ffd7bbee76c1d2e2e9b198259795285ec2c305d3613a5e39622195fd1c32bb6dbe52fa08&scene=21#wechat_redirect)  

—————END—————

喜欢本文的朋友们，欢迎长按下图关注订阅号**程序员小灰**，收看更多精彩内容

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoBj18gILw2hefgpNaCia1eRhNCzRx29e1DpVhicyenCic4RQibDTbzySoqqpOrmBxu7KlLZM73YDDPJg/640?wx_fmt=jpeg)