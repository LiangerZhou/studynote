> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 https://mp.weixin.qq.com/s?__biz=MzIxMjE5MTE1Nw==&mid=2653191389&idx=1&sn=c1728de0464bfc00931fe2c36812a80a&chksm=8c990e07bbee87115480d733a869044183422deb39397dc3a06bf637d7f66639f2c2bbeec71d&scene=21#wechat_redirect

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrCvItSygyUXcDkykpFIe2uL8D9OYF8HFeeN2ibWzWuCkxfqPY9c59tjvEg59yZk2ZiaDpUMq24b5pg/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrCvItSygyUXcDkykpFIe2u7NzkwiaVjBE14aicG0K9Sl2XOichBic8qCmq9yhk4y0Zib8eIu2JzKsSnAQ/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrCvItSygyUXcDkykpFIe2uYa7l7djKiaauqYvCrqW0oSwZOxUSbfzeq61wZjD8Uic0cM0mFkicJSpfg/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrCvItSygyUXcDkykpFIe2uO8JDt8hADiagZmdcA82VMzKYgjbaVFzk3dnuvO0QbibWBFiaCcoRY8umw/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrCvItSygyUXcDkykpFIe2uyQXSD2LMU4TcDaicvp88BJ4ALNu15Ss48b9ibm0kEHTDRAh4VKOcIDgA/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrCvItSygyUXcDkykpFIe2uYTr7F8DWxItxUnib097lPlPk60vanPrlBxlUWDzCic5tFoZgb71iayicsQ/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrCvItSygyUXcDkykpFIe2uYcqJlOYQSR0STV2KTMxib5icHNUnOJ4XOojh7YQ2KQdD9fxCQ10Fbdhg/0?wx_fmt=jpeg)

比如像这样子：

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGrCvItSygyUXcDkykpFIe2u24dKRY8TDPiaFg6ItEO2zxRCQW4gtPdepZVUUBHv8lgeiboKVe9yMyrg/0?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrCvItSygyUXcDkykpFIe2uWaSiaIu994E2ibibkNYe53fxYlGN6ePu73YARklbBI9U3z1Cbia7jOnULQ/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrCvItSygyUXcDkykpFIe2uPIUZcrmfz4eBlEDFR2ygOvoPpCwwLia3ZcJ5uPnN3DSBGFJy36NuqFA/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrCvItSygyUXcDkykpFIe2u6cfibBt6cAeGdibSTTE0s4oBd9HxNTk8prV04F7qYVK2B4yhVpxMKzBw/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGo7TJWg72gsgfhtx63epeoA9cRRwUVFJgoBtjYd1zVnt8oITdvAZuXlLfuKTZLbfZu3topOHCibmibw/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGo7TJWg72gsgfhtx63epeoADria2ianahKlxqlqKfwSCicbIyJsPC2g2f0ok9389AWZPr808KuG9ic9WQ/0?wx_fmt=jpeg)

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGowxw9dayAfiaOnzib4prIQuRt9kibzoecdlnaP3jV5ibknUDhguHcl7eDFLVNajkkiczLbcgcpwcRNkbA/0?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGowxw9dayAfiaOnzib4prIQuRtSTekzupiab7Qvn1xsPdSIunV2MayNx1bCWB758GPiaILibD6axUVqNnQ/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGowxw9dayAfiaOnzib4prIQuRI8j3nfAZdcbhibHrcQm55ibsQPiaiahUErV4vY6BvnpxyfeW1pGsoicHGiag/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGowxw9dayAfiaOnzib4prIQuR9HDNs4Ky0BgibbIDGgQLUr4YOGIico9ouS17diaY0ic7uFAS3ULZ2dGELA/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGowxw9dayAfiaOnzib4prIQuRxf4QsMdqHrvEUYYZZRNR8JmN2Uk1Y4I5ud3klw9JYHoYYJAGEO0sMA/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGowxw9dayAfiaOnzib4prIQuR3a0hV6BEUGibMW1B4njb4OPIG41sVic7YyUHqv8NfzRyj5GVvKiaqocIQ/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGowxw9dayAfiaOnzib4prIQuR0r3BLNjZlo7CcLfiakOq5blN43lw6JOVc7KApZnHoMdpVjJpqfgwydQ/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGowxw9dayAfiaOnzib4prIQuRCZrVeAay9YTmzicpVrN8Lap9cHA32RtKJTW5G4tcrbLlhZxXSR0BJLA/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGowxw9dayAfiaOnzib4prIQuRzWD5QTeM6KJWpEMJUcS8icWaACwVexibyichQvqnYh9Srf9J9NZ7dB5Lw/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGowxw9dayAfiaOnzib4prIQuRrJfVBHYozMlibMUSAVhJH1qGM3X4o1yY8OwDia5Q5slCDU2qR8ib3B18Q/0?wx_fmt=jpeg)

**第一步：把起点放入 OpenList**

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGowxw9dayAfiaOnzib4prIQuRM6ViaaGcDDxr5tB5LNouccb6Nmico5DKtoqo8FrokuZ8ej3YpYqzqqlw/0?wx_fmt=png)

**第二步：找出 OpenList 中 F 值最小的方格，即唯一的方格 Node(1,2) 作为当前方格，并把当前格移出 OpenList，放入 CloseList。代表这个格子已到达并检查过了。**

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGowxw9dayAfiaOnzib4prIQuRZFW0UlYPXTLzlibtKpfay4BEw9M7xe6dKDiabPOIFMicMfzlr6I6adSdA/0?wx_fmt=png)

**第三步：找出当前格上下左右所有可到达的格子，看它们是否在 OpenList 当中。如果不在，加入 OpenList，计算出相应的 G、H、F 值，并把当前格子作为它们的 “父亲节点”。**

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGowxw9dayAfiaOnzib4prIQuRC8icHn0ahSPvv7tmuAQwSxrlciaKJHNz3icIAgFOBLlyE82ibppqR4Qaog/0?wx_fmt=png)

**图中，每个格子的左下方数字是 G，右下方是 H，左上方是 F。**

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGowxw9dayAfiaOnzib4prIQuRicApwDaD4PDGSWSgRALLgqOh3FDEJIbXbsA8icibPZT5qFRSZUuCzzCZA/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGowxw9dayAfiaOnzib4prIQuR4XmriclVvma0sTdaicEbUmYctibE9ialRWTvjSvw1VP7kZgoibNHGeXxrpA/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL2ODEJp6yQZb1jWu1LRTSaMSp7HhjibQph2icp7xnmBgZ6sRc58TtE0JdQ/0?wx_fmt=jpeg)

**Round2 ~ 第一步：**找出 OpenList 中 F 值最小的方格，即方格 Node(2,2) 作为当前方格，并把当前格移出 OpenList，放入 CloseList。代表这个格子已到达并检查过了。****

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL2cKoicts8EAgLpedbsuZ3HkPz28VHXHIibviammCibF14qe7IwBtb5Gdeow/0?wx_fmt=png)

**Round2 ~ **第二步：找出当前格上下左右所有可到达的格子，看它们是否在 OpenList 当中。如果不在，加入 OpenList，计算出相应的 G、H、F 值，并把当前格子作为它们的 “父亲节点”。****

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL2qxNLUtY6Qmpric3OSsR4wt9I7CmRa4Jib1xhxud06O7YyBv3cVXSjEibw/0?wx_fmt=png)

**为什么这一次 OpenList 只增加了两个新格子呢？因为 Node(3,2) 是墙壁，自然不用考虑，而 Node(1,2) 在 CloseList 当中，说明已经检查过了，也不用考虑。**

**Round3 ~ 第一步：**找出 OpenList 中 F 值最小的方格。由于这时候多个方格的 F 值相等，任意选择一个即可，比如 Node(2,3) 作为当前方格，并把当前格移出 OpenList，放入 CloseList。代表这个格子已到达并检查过了。****

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL292jGASfRsoZ6MxOpYBwS6V1JKWTyNOserPOkHQDZD8w31Sh2H5KiciaA/0?wx_fmt=png)

**Round3 ~ **第二步：找出当前格上下左右所有可到达的格子，看它们是否在 OpenList 当中。如果不在，加入 OpenList，计算出相应的 G、H、F 值，并把当前格子作为它们的 “父亲节点”。****

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL2icChaQtBGAQfVaY2Wtl6M49DONGuj6aeoT8mEgko9U2lVibicKjNdJ6Nw/0?wx_fmt=png)

**剩下的就是以前面的方式继续迭代，直到 OpenList 中出现终点方格为止。这里就仅用图片简单描述了，方格中数字表示 F 值：**

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL2ibsxsAU1I9p8yXkiaEM76Qef00hrBZBT20MX9YGPdMWvoibZMibw4H1eGg/0?wx_fmt=png)

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL203d2ltogqO9Yyibxaw9lwPjcoblIcdBzTiaGALfOXtALOQp34ZSuCvicw/0?wx_fmt=png)

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL24KxWmwXNDwvX2uHtlRtXJoiamXof63l6k0W9nE7A7AJNuq4MOhmnUOw/0?wx_fmt=png)

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL2icSiacibUbb1dEfoHUstreFSgusZYBuM2n0t6UlletCichkADQ0iaDicTYgg/0?wx_fmt=png)

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL2hZGV3WP5YjjbZN8qGNu4dRPd8pOTPbPP8VNBkT3sehkWkz48SKwRBg/0?wx_fmt=png)

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL2Jib72nqX0ib225Uo5DNYaibnrVSjuZQ92cicEATKFdRKjXLdYrKibz50BtA/0?wx_fmt=png)

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL2ByjRIVvBkAWf5MkAoZkFhHpueEqK31NM4MoMIict5vKT0VZIcjdoCOQ/0?wx_fmt=png)

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL2YOkzjlZjAZm4SN5u4lGghPaoibJkjFiawFjrTmW4dyanp4tAZicBgPc6Q/0?wx_fmt=png)

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL25SqonKngG02WNoSz53icCQ8AqsdqIONsLsNsniccS6aDDVwmEwgC6suQ/0?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL2A663C01PwdJYcibNt5GCJlLOAMeD4rrVXvrReyB9TBlISmOapVibj6VQ/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL282DQw0iaMeibA2jxsTPpFzOjLZjuw1MMqpICSWUnWAHXp52eEWyibcHNw/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGo7TJWg72gsgfhtx63epeoAw9FfmOnqqPLAXtgibholg8J7xXCvHLuJpRq3ObyN4VEFDDbgXkYM5Ag/0?wx_fmt=jpeg)

![](http://mmbiz.qpic.cn/mmbiz_png/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL2cyL69EVs3pIuWrRibanOQb7k8jDY25ZwYW4A0dLnOl0kfbV93fzoDYg/0?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL2vMHRGZZd3KracrLNickt3YVactichicjhUoOb3uqhVRmhLaHKK0wfrHpw/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL2iaZ7JrQ8hH57OPUQveVS1JV6AXjyhbBhicTZ0vc48X82FGNKicyjV4RibQ/0?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL2nb5dPN84Y55LxOPMDcwnje3fEU2Jia0KlqWPouunwPCYDicCE3iasGlOA/0?wx_fmt=jpeg)

```
public Node aStarSearch(Node start, Node end) {
    // 把起点加入 open list  
    openList.add(start);
    //主循环，每一轮检查一个当前方格节点
    while (openList.size() > 0) {
        // 在OpenList中查找 F值最小的节点作为当前方格节点
        Node current = findMinNode();
        // 当前方格节点从open list中移除
        openList.remove(current);
        // 当前方格节点进入 close list
        closeList.add(current);
        // 找到所有邻近节点
        List<Node> neighbors = findNeighbors(current);
        for (Node node : neighbors) {
            if (!openList.contains(node)) {
                //邻近节点不在OpenList中，标记父亲、G、H、F，并放入OpenList
                markAndInvolve(current, end, node);
            }
        }
        //如果终点在OpenList中，直接返回终点格子
        if (find(openList, end) != null) {
            return find(openList, end);
        }
    }
    //OpenList用尽，仍然找不到终点，说明终点不可到达，返回空
    return null;
}

```

![](https://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGrnSiaSsCh9RwiaOmu5stvKL27D6T2SQfndrPtkzQAUHZoKf46Om7iaNU7JCjuWQJfJHcjIocPia0z3SQ/0?wx_fmt=jpeg)

**几点说明：**

1. 这里对于 A * 寻路的描述做了很大的简化。实际场景中可能会遇到斜向移动、特殊地形等等因素，有些时候需要对 OpenList 中的方格进行重新标记。

2. 截图中的小游戏可不是小灰开发的，而是一款经典的老游戏，有哪位小伙伴玩过吗？

—————END—————

喜欢本文的朋友们，欢迎长按下图关注订阅号**梦见**，收看更多精彩内容

![](http://mmbiz.qpic.cn/mmbiz_jpg/NtO5sialJZGoBj18gILw2hefgpNaCia1eRhNCzRx29e1DpVhicyenCic4RQibDTbzySoqqpOrmBxu7KlLZM73YDDPJg/0?wx_fmt=jpeg)